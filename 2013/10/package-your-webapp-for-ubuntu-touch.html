<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# blog: http://ogp.me/ns/blog#">
    <meta charset="utf-8">
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//google-analytics.com">
    <link rel="dns-prefetch" href="//www.google-analytics.com">
    <link rel="dns-prefetch" href="//platform.twitter.com">
    <link rel="dns-prefetch" href="//disqus.com">
    <link rel="dns-prefetch" href="//undefined.disqus.com">
    <link rel="dns-prefetch" href="//mediacdn.disqus.com">
    <link rel="dns-prefetch" href="//daker-blog.disqus.com">
    <link rel="dns-prefetch" href="//referrer.disqus.com">
    <link rel="dns-prefetch" href="//juggler.services.disqus.com">
    <link rel="dns-prefetch" href="//realtime.services.disqus.com">
    <link rel="dns-prefetch" href="//p.twitter.com">
    <link rel="dns-prefetch" href="//cdn.api.twitter.com">
    <link rel="dns-prefetch" href="//themes.googleusercontent.com"/>
    <meta name="robots" content="index,follow">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="msvalidate.01" content="A9896803DADDF85332F6A520107ECEBE" />
    <meta name="google-site-verification" content="qA5fQYo10u0jB6kurgbIyQI03Yjm5hv99Ll68_c3jYQ" />
    <meta name="author" content="Adnane Belmadiaf">
    <link rel="author" href="https://plus.google.com/101694416703170881163" />
    <link rel="stylesheet" href="/assets/css/app.min.css" type="text/css">
    <title>Package your Webapp for Ubuntu Touch — Adnane Belmadiaf's Blog - Front-end Developer</title>
    <meta name="description" content="Last week i discovered a HTML5 game called 'X-Type', which is basically a free dual stick shooter with endless boss battles. Unfortunately this game does only work on iOS and Android and it does use the UA sniffing mechanism to serve both desktop and mobile versions, and using the Ubuntu Touch user-agent it will only serve the desktop version which will not work on the phone.">
    <meta name="keywords" content="ubuntuplanet, utouchdev">
    <meta property="og:image" content="http://daker.me/assets/images/pp_sketch.jpg">
    <meta property="og:title" content="Package your Webapp for Ubuntu Touch — Adnane Belmadiaf's Blog - Front-end Developer">
    <meta property="og:site_name" content="Adnane Belmadiaf's Blog - Front-end Developer">
    <meta property="og:type" content="article">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@AdnaneBelmadiaf">
    <meta property="twitter:image" content="http://daker.me/assets/images/pp_sketch.jpg">
    <meta property="twitter:title" content="Package your Webapp for Ubuntu Touch — Adnane Belmadiaf's Blog - Front-end Developer">
    <meta property="twitter:url" content="http://daker.me/2013/10/package-your-webapp-for-ubuntu-touch.html">
    <meta name="twitter:creator" content="@AdnaneBelmadiaf">
    <meta property="og:description" content="Last week i discovered a HTML5 game called 'X-Type', which is basically a free dual stick shooter with endless boss battles. Unfortunately this game does only work on iOS and Android and it does use the UA sniffing mechanism to serve both desktop and mobile versions, and using the Ubuntu Touch user-agent it will only serve the desktop version which will not work on the phone.">
    <meta name="twitter:description" content="Last week i discovered a HTML5 game called 'X-Type', which is basically a free dual stick shooter with endless boss battles. Unfortunately this game does only work on iOS and Android and it does use the UA sniffing mechanism to serve both desktop and mobile versions, and using the Ubuntu Touch user-agent it will only serve the desktop version which will not work on the phone.">
    <link rel="prev" title="Automate Your Dev Environment With Vagrant" href="http://daker.me/2013/09/automate-your-dev-environment-with-vagrant.html" />
    <link rel="next" title="Ubuntu Touch User-Agent" href="http://daker.me/2013/11/ubuntu-touch-user-agent.html" />
    <meta property="article:author" content="https://www.facebook.com/AdnaneBelmadiaf" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/images/apple-touch-icon-precomposed-144.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/assets/images/apple-touch-icon-precomposed-114.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/assets/images/apple-touch-icon-precomposed-72.png">
    <link rel="apple-touch-icon-precomposed" href="/assets/images/apple-touch-icon-precomposed.png">
    <link rel="shortcut icon" href="/assets/images/favicon.ico" type="image/x-icon">
    <link rel="alternate" href="/feed.xml" type="application/atom+xml">
    <link rel="alternate" href="/feed-ubuntuplanet.xml" type="application/atom+xml">
</head>
<body itemscope itemtype="http://schema.org/CreativeWork">
    <header class="site-header">
        <form action="." id="searchForm">
            <input type="search" placeholder="Search..." name="q" id="q" accesskey="s" autocomplete="off" required="">
        </form>
        <menu id="nav">
            <a href="/">Blog</a>
            <a href="/archives/">Archives</a>
            <a href="/demos/">Demos</a>
            <a href="/feed.xml">Feed</a>
        </menu>
    </header>

    <main class="content">
        <aside id="sidebar">
            <div class="post-author-info">
                <a href="/" class="post-author-image" title="Homepage">
                    <img src="/assets/images/pp_sketch.jpg" alt="Adnane Belmadiaf's Profile Picture">
                </a>
                <span class="post-author-name">Adnane Belmadiaf</span>
                <p>
                    Front-end developer
                </p>
                <div class="post-author-icons">
                    <a href="https://launchpad.net/~daker" class="icon-tux" title="Launchpad" target="_blank"></a>
                    <a href="https://github.com/daker" class="icon-github" title="Github" target="_blank"></a>
                    <a href="https://plus.google.com/101694416703170881163" class="icon-google-plus" title="Google Plus" target="_blank"></a>
                    <a href="https://twitter.com/AdnaneBelmadiaf" class="icon-twitter" title="Twitter" target="_blank"></a>
                    <a style="margin-right: 0;" href="/feed.xml" class="icon-feed" title="RSS feed" target="_blank"></a>
                </div>
            </div>
            
<div class="post-published-date"> <strong>Published</strong>
    <p>
        <time datetime="2013-10-15 23:50:00+01:00" class="post-date">Oct 15, 2013 at 23:50</time>
    </p>
</div>

<div class="post-tags">
    <strong>Tags</strong>
    <p>
        
        <a href="/tags/ubuntuplanet/" itemprop="keywords">#ubuntuplanet</a>, 
        
        <a href="/tags/utouchdev/" itemprop="keywords">#utouchdev</a>
        
    </p>
</div>


            <script type="text/javascript" src="http://cdn.adpacks.com/adpacks.js?legacyid=1290676&amp;zoneid=1386&amp;key=af6bf8f7d59e09aa41173c9e7d776de9&amp;serve=C6SI42Y&amp;placement=dakerme&amp;circle=dev" id="_adpacks_js"></script>
        </aside>

        <section class="posts">
            
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <h2 itemprop="name headline" class="post-title">Package your Webapp for Ubuntu Touch</h2>
    </header>
    <div class="post-social">
        <div class="post-social-button">
            <fb:like href="http://daker.me/2013/10/package-your-webapp-for-ubuntu-touch.html" send="false" show_faces="false"  layout="button_count" width="92" ></fb:like>
        </div>
        <div class="post-social-button">
            <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://daker.me/2013/10/package-your-webapp-for-ubuntu-touch.html" data-count="horizontal" data-text="Package your Webapp for Ubuntu Touch" data-via="AdnaneBelmadiaf" data-related="AdnaneBelmadiaf"></a>
        </div>
        <div class="post-social-button">
        <a class="FlattrButton" style="display:none;" href="http://daker.me/2013/10/package-your-webapp-for-ubuntu-touch.html" title="Package your Webapp for Ubuntu Touch" data-flattr-uid="daker" data-flattr-button="compact" data-flattr-tags="ubuntuplanet, utouchdev" data-flattr-category="text" data-flattr-lang="en_US">Last week i discovered a HTML5 game called 'X-Type', which is basically a free dual stick shooter with endless boss battles. Unfortunately this game does only work on iOS and Android and it does use the UA sniffing mechanism to serve both desktop and mobile versions, and using the Ubuntu Touch user-agent it will only serve the desktop version which will not work on the phone.</a>
        </div>
        <div class="post-social-button">
            <a href="http://bufferapp.com/add" class="buffer-add-button" data-count="horizontal" data-url="http://daker.me/2013/10/package-your-webapp-for-ubuntu-touch.html" data-via="AdnaneBelmadiaf" data-picture="http://daker.me/assets/images/pp_sketch.jpg"></a>
        </div>

        <div class="post-social-button">
            <div class="g-plusone" data-size="medium" data-href="http://daker.me/2013/10/package-your-webapp-for-ubuntu-touch.html"></div>
        </div>
    </div>
    <div class="post-content">
        <div class="post-field body" itemprop="articleBody"><p>Last week i discovered a HTML5 game called &#39;<a href="http://phoboslab.org/xtype/">X-Type</a>&#39;, which is basically a free dual stick shooter with endless boss battles. Unfortunately this game does only work on iOS and Android and it does use the UA sniffing mechanism to serve both desktop and mobile versions, and using the Ubuntu Touch user-agent it will only serve the desktop version which will not work on the phone.</p>

<p><img src="/assets/posts/xtype/xtype.png" alt="X-Type running on Ubuntu Touch"></p>

<p>First using the Qt Creator you have to create a &quot;HTML5 Touch UI&quot; project which will produce the following QML code :</p>
<pre><code data-language="js">import QtQuick 2.0
import Ubuntu.Components 0.1
import QtWebKit 3.0

MainView {
    objectName: &#34;mainView&#34;
    applicationName: &#34;com.ubuntu.developer.daker.x-type&#34;
    automaticOrientation: true

    width: units.gu(100)
    height: units.gu(75)

    Flickable {
        id: webViewFlickable
        anchors.fill: parent

        WebView {
            id: webView
            anchors.fill: parent
            url: &#34;http://phoboslab.org/xtype/&#34;
        }
    }
}
</code></pre>
<p>The problem with using the QtWebKit Webview is that the device-pixel-ratio (DPR) is not set automatically causing the content of the Webview to not scale correctly, so you&#39;ll need to get the corresponding value for your device from the <code>QTWEBKIT_DPR</code> environment variable, there is actually no way to read those variables using QML so you&#39;ll need to use some C++ code to read the <code>QTWEBKIT_DPR</code> and passe it to QML so the content of the WebView will scale accordingly.</p>

<p>The Ubuntu Touch Browser Plugin provides a component called <code>UbuntuWebView</code>, it uses some kind of UA overrides to bypass the UA sniffing used to serve the mobile version of webapp(Gmail, G+, Facebook, Twitter, etc...) and changes the UA on the fly, unfortunately there was no way to set your own UA using the <code>UbuntuWebView</code> but now you can since this <a href="https://bugs.launchpad.net/webbrowser-app/+bug/1237365">bug #1237365</a> has been fixed.</p>

<p>Also with the <code>UbuntuWebView</code> the <code>DPR</code> weren&#39;t set automatically(<a href="https://bugs.launchpad.net/webbrowser-app/+bug/1237348">bug #1237348</a>), it was also fixed and all those fixes has been shipped with image #96.</p>

<p>Here is the QML code i used to embed the &quot;X-Type&quot; game(Fullscreen) but first you need to install the browser plugin :</p>
<pre><code data-language="sh">$ sudo apt-get install qtdeclarative5-ubuntu-ui-extras-browser-plugin
</code></pre><pre><code data-language="js">import QtQuick 2.0
import Ubuntu.Components 0.1
import Ubuntu.Components.Extras.Browser 0.1


MainView {
    objectName: &#34;mainView&#34;
    applicationName: &#34;com.ubuntu.developer.daker.x-type&#34;
    //automaticOrientation: true

    width: units.gu(50)
    height: units.gu(75)

    UbuntuWebView {
        anchors.fill: parent
        url: &#34;http://phoboslab.org/xtype/&#34;
        /* This function is used to override the UA */
        function getUAString(url) {
            return &#34;Mozilla/5.0 (iPhone; CPU iPhone OS 5_0 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Version/5.1 Mobile/9A334 Safari/7534.48.3&#34;
        }
    }
}
</code></pre>
<p>you need to create a <code>manifest.json</code> file :</p>
<pre><code data-language="json">{
    &#34;description&#34;: &#34;A Free HTML5 Dual Stick Shooter&#34;,
    &#34;framework&#34;: &#34;ubuntu-sdk-13.10&#34;,
    &#34;architecture&#34;: &#34;all&#34;,
    &#34;hooks&#34;: {
        &#34;x-type&#34;: {
            &#34;apparmor&#34;: &#34;x-type.json&#34;,
            &#34;desktop&#34;: &#34;x-type.desktop&#34;
        }
    },
    &#34;maintainer&#34;: &#34;Adnane Belmadiaf &lt;daker@ubuntu.com&gt;&#34;,
    &#34;name&#34;: &#34;com.ubuntu.developer.daker.x-type&#34;,
    &#34;title&#34;: &#34;X-Type&#34;,
    &#34;version&#34;: &#34;0.4&#34;
}
</code></pre>
<p>the security policy groups <code>x-type.json</code> :</p>
<pre><code data-language="json">{
    &#34;policy_groups&#34;: [
        &#34;networking&#34;
    ],
    &#34;policy_version&#34;: 1
}
</code></pre>
<p>and a .desktop file :</p>
<pre><code data-language="js">[Desktop Entry]
Name=x-type
Comment=A Free HTML5 Dual Stick Shooter
Exec=qmlscene $@ x-type.qml
Icon=./x-type.png
Terminal=false
Type=Application
X-Ubuntu-Touch=true
</code></pre>
<p>you need to add the icon and now all you have to do is to build the click package using <code>click build .</code>and <a href="https://myapps.developer.ubuntu.com/dev/click-apps/new/">upload</a> it to the store. I have also packaged another HTML5 game called <a href="http://heliom.github.io/bytesjack/">BytesJack</a> using the same method, the source code of both games can be found <a href="https://bazaar.launchpad.net/%7Edaker/+junk/x-type/files">here</a> and <a href="https://bazaar.launchpad.net/%7Edaker/+junk/bytesjack/files">here</a>.</p>

<p>Happy hacking!</p>
</div>
    </div>

    <form action="http://daker.us7.list-manage.com/subscribe/post?u=ebd280d4e0da7cce97bd7a8ad&amp;id=327b2cec50" method="post" id="signup" name="signup-form">
        <div class="row">
            <input type="email" name="EMAIL" id="email" required="required" placeholder="Your E-mail address will be safe.">
            <a href="/feed.xml" class="icon-feed " title="Subscribe to the RSS feed" target="_blank"></a>
            <input type="submit" value="Subscribe" name="subscribe" id="subscribe-btn">
        </div>
    </form>
    <div id="response" style="display:none"></div>
    <div class="notice">By joining you'll receive a weekly e-mail with latest blog posts each Wednesday. Easy unsubscribe. No spam — your e-mail address will be safe.</div>

    
    <div class="prev-next">
        
        <div class="prev-post">
            <a href="/2013/09/automate-your-dev-environment-with-vagrant.html" title="Automate Your Dev Environment With Vagrant" class="title">
                <span>Automate Your Dev Environment With Vagrant</span>
            </a>
        </div>
        
        
        <div class="next-post">
            <a href="/2013/11/ubuntu-touch-user-agent.html" title="Ubuntu Touch User-Agent" class="title">
                <span>Ubuntu Touch User-Agent</span>
            </a>
        </div>
        
    </div>
    
</article>
<section id="comment">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'daker-blog';
        var disqus_title = 'Package your Webapp for Ubuntu Touch';
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>
        Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
    </noscript>
</section>

        </section>
    </main>

    <footer class="site-footer">
        <p class="copyright">
            Copyright &copy; 2014 Adnane Belmadiaf<br />
            This work is licensed under a <a rel="license" target="_blank" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>
        </p>
    </footer>
    <script type="text/javascript" charset="utf-8" src="//code.jquery.com/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="/assets/js/jquery.ba-hashchange.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="/assets/js/main.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-41135963-1', 'daker.me');
      ga('send', 'pageview');
    </script>
    
<script type="text/javascript" charset="utf-8" src="/assets/js/rainbow.min.js"></script>
<script type="text/javascript" charset="utf-8" src="/assets/js/languages/css.js"></script>
<script type="text/javascript" charset="utf-8" src="/assets/js/languages/html.js"></script>
<script type="text/javascript" charset="utf-8" src="/assets/js/languages/javascript.js"></script>
<script type="text/javascript" charset="utf-8" src="/assets/js/languages/python.js"></script>
<script type="text/javascript" charset="utf-8" src="/assets/js/languages/qml.js"></script>
<script type="text/javascript" src="//connect.facebook.net/en_US/all.js#xfbml=1"></script>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
<script type="text/javascript">
    (function() {
        var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
        po.src = 'https://apis.google.com/js/plusone.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
</script>
<script type="text/javascript" src="http://static.bufferapp.com/js/button.js"></script>
<script type="text/javascript">
(function() {
    var s = document.createElement('script'), t = document.getElementsByTagName('script')[0];
    s.type = 'text/javascript';
    s.async = true;
    s.src = 'http://api.flattr.com/js/0.6/load.js?mode=auto';
    t.parentNode.insertBefore(s, t);
})();
</script>
</body>
</html>