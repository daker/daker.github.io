<!DOCTYPE html><html lang="en"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# blog: http://ogp.me/ns/blog#"> <meta charset="utf-8"> <meta content="width=device-width,initial-scale=1" name="viewport"> <meta content="#dda448" name="theme-color"> <title>Automate Your Dev Environment With Vagrant</title> <meta content="Adnane Belmadiaf's blog." name="description"> <style>@font-face{font-family:Lora;font-style:normal;font-weight:700;font-display:swap;src:local("Lora Bold"),local("Lora-Bold"),url(/assets/css/fonts/lora-v13-latin-700.woff2) format("woff")}@font-face{font-family:Lora;font-style:normal;font-weight:300;font-display:swap;src:local("Lora"),local("Lora"),url(/assets/css/fonts/lora-v13-latin-regular.woff2) format("woff")}</style> <style>:root{--color-jonquil:#f9c80e;--color-fireopal:#e9573f;--color-sunray:#dda448;--color-onyx:#444;--color-eerieblack:#222;--vb:1.5em;--font-family-text:"Lora",Arial,Tahoma,sans-serif;--font-family-headline:"Lora",Arial,Tahoma,sans-serif;--font-family-monospace:Consolas,Menlo,Monaco,Andale Mono WT,Andale Mono,Lucida Console,Lucida Sans Typewriter,DejaVu Sans Mono,Bitstream Vera Sans Mono,Liberation Mono,Nimbus Mono L,Courier New,Courier,monospace;--background-color:#fff;--text-color:var(--color-onyx);--text-color-link:var(--color-fireopal);--text-color-link-hover:var(--color-sunray);--background-color-footer:#f9f9f9;--border-color-avatar:var(--color-fireopal);--text-color-code:var(--color-onyx);--border-color-footer:#ddd;--text-color-footer:var(--color-onyx)}:root[data-color-scheme=dark]{--background-color:var(--color-eerieblack);--text-color:#fff;--text-color-link:var(--color-sunray);--text-color-link-hover:var(--color-jonquil);--background-color-footer:#1f1f1f;--border-color-avatar:var(--color-sunray);--text-color-code:#fff;--border-color-footer:#333;--text-color-footer:var(--text-color)}.theme-switcher{color:var(--text-color);float:right}:root[data-color-scheme=dark] #dark-mode-toggle{background:url("data:image/svg+xml,%3csvg version='1.2' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' height='20' width='20'%3e %3cg fill='%23fff'%3e %3cpath d='M11.964 3.284c.021.237.036.474.036.716a8 8 0 0 1-8 8c-.242 0-.479-.015-.716-.036a7 7 0 1 0 8.68-8.68z' fill-opacity='.2' stroke='%23fff' stroke-linecap='round' stroke-linejoin='round' stroke-width='1'%3e%3c/path%3e %3cpath d='M7 4a.979.979 0 0 1-1-1 1 1 0 0 0-2 0 .979.979 0 0 1-1 1 1 1 0 0 0 0 2 .979.979 0 0 1 1 1 1 1 0 0 0 2 0 .979.979 0 0 1 1-1 1 1 0 0 0 0-2z'%3e%3c/path%3e %3c/g%3e %3c/svg%3e") no-repeat center center}#dark-mode-toggle{background:url("data:image/svg+xml,%3csvg version='1.2' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' height='20' width='20'%3e %3cg fill='%23444'%3e %3ccircle cx='10' cy='10' r='4' fill-opacity='.2' stroke='%23444' stroke-linecap='round' stroke-linejoin='round' stroke-width='1'%3e%3c/circle%3e %3cpath fill='none' stroke='%23444' stroke-linecap='round' stroke-linejoin='round' stroke-width='1' d='M10 1v1.5'%3e%3c/path%3e %3cpath fill='none' stroke='%23444' stroke-linecap='round' stroke-linejoin='round' stroke-width='1' d='M16.364 3.636l-1.061 1.061'%3e%3c/path%3e %3cpath fill='none' stroke='%23444' stroke-linecap='round' stroke-linejoin='round' stroke-width='1' d='M19 10h-1.5'%3e%3c/path%3e %3cpath fill='none' stroke='%23444' stroke-linecap='round' stroke-linejoin='round' stroke-width='1' d='M16.364 16.364l-1.061-1.061'%3e%3c/path%3e %3cpath fill='none' stroke='%23444' stroke-linecap='round' stroke-linejoin='round' stroke-width='1' d='M10 19v-1.5'%3e%3c/path%3e %3cpath fill='none' stroke='%23444' stroke-linecap='round' stroke-linejoin='round' stroke-width='1' d='M3.636 16.364l1.061-1.061'%3e%3c/path%3e %3cpath fill='none' stroke='%23444' stroke-linecap='round' stroke-linejoin='round' stroke-width='1' d='M1 10h1.5'%3e%3c/path%3e %3cpath fill='none' stroke='%23444' stroke-linecap='round' stroke-linejoin='round' stroke-width='1' d='M3.636 3.636l1.061 1.061'%3e%3c/path%3e %3c/g%3e %3c/svg%3e") no-repeat center center;border:0;width:20px;height:20px;cursor:pointer}@media (prefers-color-scheme:dark){:root{--background-color:var(--color-eerieblack);--text-color:#fff;--text-color-link:var(--color-sunray);--text-color-link-hover:var(--color-jonquil);--background-color-footer:#1f1f1f;--border-color-avatar:var(--color-sunray);--text-color-code:#fff;--border-color-footer:#333;--text-color-footer:var(--text-color)}}*{box-sizing:border-box}@media (prefers-reduced-motion:reduce){*,::after,::before{transition-duration:0s!important;animation-duration:0s!important}}body,html{padding:0;margin:0;font-family:var(--font-family-text);color:var(--text-color);background-color:var(--background-color)}body::before,hr{background-image:linear-gradient(to right,var(--color-jonquil),var(--color-fireopal))}hr{height:4px;border-radius:4px;border:0}@media (min-width:768px){body{font-size:120%}}.post li,p{line-height:1.45}a[href]{color:var(--text-color-link);text-decoration:none}a[href]:hover{color:var(--text-color-link-hover);text-decoration:underline}main{padding:0;margin:0}main h1{font-family:var(--font-family-headline);font-size:3em}main .container{max-width:80ch;padding-left:1em;padding-right:1em;width:100%;margin:0 auto}@media (min-width:768px){.container{padding-left:2em;padding-right:2em}}header,hr{margin:var(--vb) 0}header .avatar{display:block;margin:0 auto;max-width:290px}header .avatar img{width:50%;height:50%;margin:0 auto;display:block;border:3px solid var(--border-color-avatar);border-radius:50%}header .me{display:block;text-align:center;margin-top:1em;font-size:1.5em;font-weight:700}header .links{margin-top:1.2em;text-align:center}header .link:not(:last-of-type){margin-right:1em}header .link{display:inline-block;height:34px;width:34px}header .link .icon{stroke:currentColor;fill:none}table{margin:1em 0}table td,table th{padding-right:1em}.home{padding:0 1em;margin:1.5em 0;font-size:1em}.home :link:not(:hover){text-decoration:none}.post-list{list-style:none;padding:0}.post-list__item{align-items:baseline;margin-bottom:1.8em}.post-list__date,.post-list__item:before{font-size:.8125em;color:var(--color-gray-90)}.post-list__date,pre code{display:block}.post-list__link{font-size:1.5em}.post-list__item-active .post-list__link{font-weight:700}.post-tags{text-align:center}.post-tag{display:inline-flex;align-items:center;justify-content:center;background:url("data:image/svg+xml,%3csvg version='1.2' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 28 28' width='28' height='28' fill='%23dda448'%3e %3cpath d='M15.484 16l1-4h-3.969l-1 4h3.969zM27.484 8.125l-0.875 3.5c-0.063 0.219-0.25 0.375-0.484 0.375h-5.109l-1 4h4.859c0.156 0 0.297 0.078 0.391 0.187 0.094 0.125 0.141 0.281 0.094 0.438l-0.875 3.5c-0.047 0.219-0.25 0.375-0.484 0.375h-5.109l-1.266 5.125c-0.063 0.219-0.266 0.375-0.484 0.375h-3.5c-0.156 0-0.313-0.078-0.406-0.187-0.094-0.125-0.125-0.281-0.094-0.438l1.219-4.875h-3.969l-1.266 5.125c-0.063 0.219-0.266 0.375-0.484 0.375h-3.516c-0.141 0-0.297-0.078-0.391-0.187-0.094-0.125-0.125-0.281-0.094-0.438l1.219-4.875h-4.859c-0.156 0-0.297-0.078-0.391-0.187-0.094-0.125-0.125-0.281-0.094-0.438l0.875-3.5c0.063-0.219 0.25-0.375 0.484-0.375h5.109l1-4h-4.859c-0.156 0-0.297-0.078-0.391-0.187-0.094-0.125-0.141-0.281-0.094-0.438l0.875-3.5c0.047-0.219 0.25-0.375 0.484-0.375h5.109l1.266-5.125c0.063-0.219 0.266-0.375 0.5-0.375h3.5c0.141 0 0.297 0.078 0.391 0.187 0.094 0.125 0.125 0.281 0.094 0.438l-1.219 4.875h3.969l1.266-5.125c0.063-0.219 0.266-0.375 0.5-0.375h3.5c0.141 0 0.297 0.078 0.391 0.187 0.094 0.125 0.125 0.281 0.094 0.438l-1.219 4.875h4.859c0.156 0 0.297 0.078 0.391 0.187 0.094 0.125 0.125 0.281 0.094 0.438z'%3e%3c/path%3e %3c/svg%3e") no-repeat left center;background-size:20px;padding-left:1.3em;margin-left:.5em;margin-top:.5em;margin-bottom:.5em;text-decoration:none}a[href].post-tag,a[href].post-tag:visited{color:inherit}a[href].post-tag:focus,a[href].post-tag:hover{background-color:var(--color-gray-20)}.postlist-item>.post-tag{align-self:center}.post{margin-top:1em}.post .post-title{text-align:center;margin-bottom:.3em}.post .post-date{text-align:center}.collection-nav::before,.post-title{background-image:linear-gradient(to right,var(--color-fireopal),var(--color-jonquil))}.post-title{background-clip:text;-webkit-background-clip:text;-webkit-text-fill-color:transparent}.post img{max-width:100%;height:auto;display:block;margin:0 auto}.collection-nav{display:flex;justify-content:space-between;font-size:90%;margin-top:calc(var(--vb)*3);position:relative}.collection-nav::before{content:"";position:absolute;bottom:100%;left:0;right:0;height:4px;border-radius:4px}.collection-nav__item{max-width:50%;position:relative;margin-top:var(--vb);line-height:1.1}.collection-nav__item--next{text-align:right}.collection-nav__item--next::after,.collection-nav__item--previous::before{position:absolute;top:0;color:#f9c80e;font-weight:700}.collection-nav__item--previous::before{right:100%;margin-right:1ch}.collection-nav__item--next::after{left:100%;margin-left:1ch}.collection-nav--end{justify-content:flex-end}@media (min-width:768px){.collection-nav__item--previous{padding-left:30px;background:url("data:image/svg+xml,%3csvg version='1.2' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24' fill='%23dda448'%3e %3cpath d='m0 12l11-11 2.8 2.8-6.2 6.2h16.4v4h-16.4l6.2 6.2-2.8 2.8z'/%3e %3c/svg%3e") no-repeat left center}.collection-nav__item--next{padding-right:30px;background:url("data:image/svg+xml,%3csvg version='1.2' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24' fill='%23dda448'%3e %3cpath d='M13.025 1l-2.847 2.828 6.176 6.176h-16.354v3.992h16.354l-6.176 6.176 2.847 2.828 10.975-11z'%3e%3c/path%3e %3c/svg%3e") no-repeat right center}}code{font-family:var(--code-font);word-wrap:break-word;overflow-wrap:break-word;font-size:80%}:not(pre):not(a)>code{color:var(--text-color-code);border-radius:.25em;padding:0 .2em;font-size:70%}footer{background:var(--background-color-footer);padding:1.5em 0;overflow:hidden;border-top:1px solid var(--border-color-footer);margin-top:15px}.footer__colophon,.footer__copyright{font-size:14px;text-align:center;color:var(--text-color-footer);line-height:1.5em;margin:0}.footer__colophon{font-style:italic}</style> <link href="/feed.xml" rel="alternate" title="Adnane Belmadiaf's Blog - R&amp;D engineer" type="application/atom+xml"> <link href="/assets/img/favicon.jpg" rel="shortcut icon"> <link href="/assets/img/favicon.jpg" rel="apple-touch-icon"> <link href="/manifest.json" rel="manifest"> <meta content="Automate Your Dev Environment With Vagrant" property="og:title"> <meta content="article" property="og:type"> <meta content="" property="og:url"> <meta content="" property="og:description"> <meta content="daker.me" property="og:site_name"> <meta content="summary" name="twitter:card"> <meta content="@AdnaneBelmadiaf" name="twitter:creator"> <meta content="" name="twitter:description"> <meta content="daker.me" name="twitter:domain"> <meta content="https://daker.me/assets/images/favicon-192.jpg" name="twitter:image"> <meta content="@AdnaneBelmadiaf" name="twitter:site"> <meta content="Automate Your Dev Environment With Vagrant" name="twitter:title"> <!-- Register service worker for PWA offline mode support. -->
      <script>
        if ("serviceWorker" in window.navigator) {
          window.addEventListener("load", () =>
            window.navigator.serviceWorker.register("/service-worker.js", { scope: "/" }),
          );
        }
      </script></head> <body itemscope="" itemtype="http://schema.org/CreativeWork"> <header> <div class="container"> <div class="theme-switcher"> <button id="dark-mode-toggle" title="Switch mode"></button> </div> <a href="/" class="avatar"> <img alt="Adnane Belmadiaf's Blog - R&amp;D engineer" src="/assets/img/avatar.webp" height="145" width="145" decoding="async" loading="lazy"> </a> <span class="me">Adnane Belmadiaf</span> <div class="links"> <a href="https://github.com/daker" class="link" target="_blank" title="Github"> <svg class="icon" role="img" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg> </a> <a href="https://twitter.com/AdnaneBelmadiaf" class="link" target="_blank" title="Twitter"> <svg class="icon" role="img" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" height="32" width="32"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path></svg> </a> <a href="/feed.xml" class="link" target="_blank" title="RSS feed"> <svg class="icon" role="img" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" viewBox="0 0 24 26" xmlns="http://www.w3.org/2000/svg" height="32" width="32"><path d="M19.199 24C19.199 13.467 10.533 4.8 0 4.8V0c13.165 0 24 10.835 24 24h-4.801zM3.291 17.415c1.814 0 3.293 1.479 3.293 3.295 0 1.813-1.485 3.29-3.301 3.29C1.47 24 0 22.526 0 20.71s1.475-3.294 3.291-3.295zM15.909 24h-4.665c0-6.169-5.075-11.245-11.244-11.245V8.09c8.727 0 15.909 7.184 15.909 15.91z"></path></svg> </a> </div> </div> </header> <main class="post" id="main" role="main"> <div class="container"> <h1 class="post-title" itemprop="title">Automate Your Dev Environment With Vagrant</h1> <article class="post" itemscope="" itemtype="http://schema.org/BlogPosting"> <p class="post-date"> <span itemprop="datePublished"> <time datetime="2013-09-29">September 29, 2013</time> </span> </p> <p class="post-tags"> <a href="/tags/vagrant/" class="post-tag">vagrant</a> <a href="/tags/ubuntuplanet/" class="post-tag">ubuntuplanet</a> </p> <div itemprop="articleBody"> <p>I started feeling the need of automating my developement environments when i started contributing to several django projects run by the community, each project uses a different django version and several dependencies, thoses dependencies can be found or not on the Ubuntu version i use for my daily work. Vagrant is a great tool for those situations, it allow you to create and manage custom virtual environments to your needs using automated configuration technologies such as Chef, Puppet and Shell scripts.</p> <p><img alt="Vagrant" src="/assets/posts/vagrant/vagrant.jpg" width="600" height="338" decoding="async" loading="lazy"></p> <h2>Installing Vagrant</h2> <p>Vagrant works with VirtualBox, and support <a href="http://www.vagrantup.com/vmware">Vmware Fusion</a> and AWS via plugins</p> <h3>Install Virtualbox</h3> <pre class="language-sh"><code class="language-sh">$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> virtualbox</code></pre> <h3>Install Vagrant</h3> <pre class="language-sh"><code class="language-sh">$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> vagrant</code></pre> <p>Make sure Vagrant is installed correctly</p> <pre class="language-sh"><code class="language-sh">$ vagrant <span class="token variable parameter">--version</span><br>Vagrant version <span class="token number">1.2</span>.0</code></pre> <h2>Get your first VM up and running</h2> <ol> <li> <p>start a vagrant config file in an empty project folder. this will create <code>Vagrantfile</code></p> <pre class="language-sh"><code class="language-sh">$ <span class="token function">mkdir</span> project<br>$ <span class="token builtin class-name">cd</span> project<br>$ vagrant init</code></pre> </li> <li> <p>edit <code>Vagrantfile</code> to add the boxname</p> <pre class="language-ruby"><code class="language-ruby">Vagrant<span class="token punctuation double-colon">::</span>Config<span class="token punctuation">.</span>run <span class="token keyword">do</span> <span class="token operator">|</span>config<span class="token operator">|</span><br>    config<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>box <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"devserver"</span></span><br><span class="token keyword">end</span></code></pre> </li> <li> <p>add a base image or box to quickly clone a virtual machine. this will create a folder .vagrant with an ubuntu box</p> <pre class="language-sh"><code class="language-sh">$ vagrant box <span class="token function">add</span> devserver http://files.vagrantup.com/precise32.box</code></pre> </li> <li> <p>then you are ready to go</p> <pre class="language-sh"><code class="language-sh">$ vagrant up<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Importing base box <span class="token string">'precise32'</span><span class="token punctuation">..</span>.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Matching MAC address <span class="token keyword">for</span> NAT networking<span class="token punctuation">..</span>.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Clearing any previously <span class="token builtin class-name">set</span> forwarded ports<span class="token punctuation">..</span>.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Forwarding ports<span class="token punctuation">..</span>.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> -- <span class="token number">22</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">2222</span> <span class="token punctuation">(</span>adapter <span class="token number">1</span><span class="token punctuation">)</span><br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Creating shared folders metadata<span class="token punctuation">..</span>.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Clearing any previously <span class="token builtin class-name">set</span> network interfaces<span class="token punctuation">..</span>.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Booting VM<span class="token punctuation">..</span>.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Waiting <span class="token keyword">for</span> VM to boot. This can take a few minutes.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> VM booted and ready <span class="token keyword">for</span> use<span class="token operator">!</span><br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Mounting shared folders<span class="token punctuation">..</span>.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> -- v-root: /vagrant<br><span class="token punctuation">[</span><span class="token punctuation">..</span>.<span class="token punctuation">]</span></code></pre> </li> </ol> <p>Wait for the command to finish, then you will have a VM ready for you to connect. the VM can be accessed via SSH:</p> <pre class="language-sh"><code class="language-sh">$ vagrant <span class="token function">ssh</span></code></pre> <h2>Provisioning</h2> <p>Vagrant allow you to use different Provisioners to easily setup your VM with everything it needs to run your project :</p> <ul> <li>Chef Solo</li> <li>Chef Server</li> <li>Puppet Standalone</li> <li>Puppet Server</li> <li>Shell</li> </ul> <p>I do prefer Puppet for provisioning, because it's easy and it allow you to easily create a manifest to control the package, file or service with a few lines of code.</p> <p>Here is the <code>Vagrantfile</code> i use, i needed to forward the port 8000 because i want to access the webapp using my browser, i also increased the memory of the VM to 1GB, and made the project folder accessible to the VM :</p> <pre class="language-ruby"><code class="language-ruby"><span class="token comment"># -*- mode: ruby -*-</span><br><span class="token comment"># vi: set ft=ruby :</span><br><br>Vagrant<span class="token punctuation double-colon">::</span>Config<span class="token punctuation">.</span>run <span class="token keyword">do</span> <span class="token operator">|</span>ltp<span class="token operator">|</span><br><br>    ltp<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>box <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"ltp-devserver"</span></span><br>    ltp<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>box_url <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"http://files.vagrantup.com/precise32.box"</span></span><br>    ltp<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>forward_port <span class="token number">8000</span><span class="token punctuation">,</span> <span class="token number">8000</span><br>    ltp<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>network <span class="token symbol">:hostonly</span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"33.33.33.10"</span></span><br>    ltp<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>customize <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"modifyvm"</span></span><span class="token punctuation">,</span> <span class="token symbol">:id</span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"--memory"</span></span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">]</span><br><br>    ltp<span class="token punctuation">.</span>ssh<span class="token punctuation">.</span>max_tries <span class="token operator">=</span> <span class="token number">50</span><br>    ltp<span class="token punctuation">.</span>ssh<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">300</span><br><br>    ltp<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>share_folder<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"v-root"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"/home/vagrant/ltp"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"."</span></span><span class="token punctuation">)</span><br><br>    ltp<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>provision <span class="token symbol">:puppet</span> <span class="token keyword">do</span> <span class="token operator">|</span>puppet<span class="token operator">|</span><br>        puppet<span class="token punctuation">.</span>manifests_path <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"puppet/manifests"</span></span><br>        puppet<span class="token punctuation">.</span>manifest_file  <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"vagrant.pp"</span></span><br>    <span class="token keyword">end</span><br><span class="token keyword">end</span></code></pre> <p>here one of the classes i use on my dev environement :</p> <pre class="language-sh"><code class="language-sh">class init <span class="token punctuation">{</span><br><br>    group <span class="token punctuation">{</span> <span class="token string">"puppet"</span><span class="token builtin class-name">:</span><br>        ensure <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"present"</span>,<br>    <span class="token punctuation">}</span><br><br>    <span class="token comment"># Let's update the system</span><br>    <span class="token builtin class-name">exec</span> <span class="token punctuation">{</span> <span class="token string">"update-apt"</span><span class="token builtin class-name">:</span><br>        <span class="token builtin class-name">command</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"sudo apt-get update"</span>,<br>    <span class="token punctuation">}</span><br><br>    <span class="token comment"># Let's install the dependecies</span><br>    package <span class="token punctuation">{</span><br>        <span class="token punctuation">[</span><span class="token string">"python"</span>, <span class="token string">"python-dev"</span>, <span class="token string">"libjs-jquery"</span>, <span class="token string">"libjs-jquery-ui"</span>, <span class="token string">"iso-codes"</span>, <span class="token string">"gettext"</span>, <span class="token string">"python-pip"</span>, <span class="token string">"bzr"</span><span class="token punctuation">]</span>:<br>        ensure <span class="token operator">=</span><span class="token operator">&gt;</span> installed,<br>        require <span class="token operator">=</span><span class="token operator">&gt;</span> Exec<span class="token punctuation">[</span><span class="token string">'update-apt'</span><span class="token punctuation">]</span> <span class="token comment"># The system update needs to run first</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment"># Let's install the project dependecies from pip</span><br>    <span class="token builtin class-name">exec</span> <span class="token punctuation">{</span> <span class="token string">"pip-install-requirements"</span><span class="token builtin class-name">:</span><br>        <span class="token builtin class-name">command</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"sudo /usr/bin/pip install -r <span class="token variable">$PROJ_DIR</span>/requirements.txt"</span>,<br>        tries <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">2</span>,<br>        <span class="token function">timeout</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">600</span>, <span class="token comment"># Too long, but this can take awhile</span><br>        require <span class="token operator">=</span><span class="token operator">&gt;</span> Package<span class="token punctuation">[</span><span class="token string">'python-pip'</span>, <span class="token string">'python-dev'</span><span class="token punctuation">]</span>, <span class="token comment"># The package dependecies needs to run first</span><br>        logoutput <span class="token operator">=</span><span class="token operator">&gt;</span> on_failure,<br>    <span class="token punctuation">}</span><br><br><span class="token punctuation">}</span></code></pre> <p>You need to specify one manifest file in your Vagranfile, if you need to split it, you can use something like this :</p> <pre class="language-sh"><code class="language-sh">$ tree<br><span class="token builtin class-name">.</span><br>└── manifests<br>    ├── classes<br>    │   ├── init.pp<br>    │   └── ltp.pp<br>    └── vagrant.pp</code></pre> <p>I use <code>vagrant.pp</code> to define my project variables, and to make sure all the classes are executed in the order i want :</p> <pre class="language-sh"><code class="language-sh"><span class="token function">import</span> <span class="token string">"classes/*.pp"</span><br><br><span class="token variable">$PROJ_DIR</span> <span class="token operator">=</span> <span class="token string">"/home/vagrant/ltp"</span><br><br>Exec <span class="token punctuation">{</span><br>    path <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin"</span>,<br><span class="token punctuation">}</span><br><br>class dev <span class="token punctuation">{</span><br><br>    class <span class="token punctuation">{</span><br>        init: before <span class="token operator">=</span><span class="token operator">&gt;</span> Class<span class="token punctuation">[</span>ltp<span class="token punctuation">]</span><span class="token punctuation">;</span><br>        ltp:<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>include dev</code></pre> <p>The <code>ltp</code> class is only used to run some <code>django</code> commands :</p> <pre class="language-sh"><code class="language-sh">class ltp <span class="token punctuation">{</span><br><br>    <span class="token function">file</span> <span class="token punctuation">{</span> <span class="token string">"<span class="token variable">$PROJ_DIR</span>/loco_directory/local_settings.py"</span><span class="token builtin class-name">:</span><br>        ensure <span class="token operator">=</span><span class="token operator">&gt;</span> file,<br>        <span class="token builtin class-name">source</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"<span class="token variable">$PROJ_DIR</span>/loco_directory/local_settings.py.sample"</span>,<br>        replace <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">false</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token builtin class-name">exec</span> <span class="token punctuation">{</span><br>        <span class="token string">"db_download"</span><span class="token builtin class-name">:</span><br>            cwd <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"<span class="token variable">$PROJ_DIR</span>/loco_directory"</span>,<br>            <span class="token builtin class-name">command</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"/usr/bin/wget http://people.ubuntu.com/~daker/ltp/ltp.db"</span>,<br>            creates <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"<span class="token variable">$PROJ_DIR</span>/loco_directory/ltp.db"</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token builtin class-name">exec</span> <span class="token punctuation">{</span><br>        <span class="token string">"managepy_syncdb"</span><span class="token builtin class-name">:</span><br>            cwd <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"<span class="token variable">$PROJ_DIR</span>/loco_directory"</span>,<br>            <span class="token builtin class-name">command</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"/usr/bin/python manage.py syncdb --noinput"</span>,<br>    <span class="token punctuation">}</span><br><br>    <span class="token builtin class-name">exec</span> <span class="token punctuation">{</span><br>        <span class="token string">"managepy_migratedb"</span><span class="token builtin class-name">:</span><br>            cwd <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"<span class="token variable">$PROJ_DIR</span>/loco_directory"</span>,<br>            <span class="token builtin class-name">command</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"/usr/bin/python manage.py migrate"</span>,<br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre> <p>Now all i have to do is <code>vagrant up</code> and let Vagrant do all his magic tricks :</p> <pre class="language-sh"><code class="language-sh">$ vagrant up<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Importing base box <span class="token string">'ltp-devserver'</span><span class="token punctuation">..</span>.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Matching MAC address <span class="token keyword">for</span> NAT networking<span class="token punctuation">..</span>.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Clearing any previously <span class="token builtin class-name">set</span> forwarded ports<span class="token punctuation">..</span>.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Forwarding ports<span class="token punctuation">..</span>.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> -- <span class="token number">22</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">2222</span> <span class="token punctuation">(</span>adapter <span class="token number">1</span><span class="token punctuation">)</span><br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> -- <span class="token number">8000</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">8000</span> <span class="token punctuation">(</span>adapter <span class="token number">1</span><span class="token punctuation">)</span><br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Creating shared folders metadata<span class="token punctuation">..</span>.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Clearing any previously <span class="token builtin class-name">set</span> network interfaces<span class="token punctuation">..</span>.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Preparing network interfaces based on configuration<span class="token punctuation">..</span>.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Running any VM customizations<span class="token punctuation">..</span>.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Booting VM<span class="token punctuation">..</span>.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Waiting <span class="token keyword">for</span> VM to boot. This can take a few minutes.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> VM booted and ready <span class="token keyword">for</span> use<span class="token operator">!</span><br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Configuring and enabling network interfaces<span class="token punctuation">..</span>.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Mounting shared folders<span class="token punctuation">..</span>.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> -- v-root: /home/vagrant/ltp<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> -- manifests: /tmp/vagrant-puppet/manifests<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Running provisioner: Vagrant::Provisioners::Puppet<span class="token punctuation">..</span>.<br><span class="token punctuation">[</span>default<span class="token punctuation">]</span> Running Puppet with /tmp/vagrant-puppet/manifests/vagrant.pp<span class="token punctuation">..</span>.<br>stdin: is not a <span class="token function">tty</span><br>warning: Could not retrieve fact fqdn<br><br>notice: /Stage<span class="token punctuation">[</span>main<span class="token punctuation">]</span>/Init/Exec<span class="token punctuation">[</span>update-apt<span class="token punctuation">]</span>/returns: executed successfully<br><br>notice: /Stage<span class="token punctuation">[</span>main<span class="token punctuation">]</span>/Init/Package<span class="token punctuation">[</span>python-pip<span class="token punctuation">]</span>/ensure: ensure changed <span class="token string">'purged'</span> to <span class="token string">'present'</span><br><br>notice: /Stage<span class="token punctuation">[</span>main<span class="token punctuation">]</span>/Init/Package<span class="token punctuation">[</span>bzr<span class="token punctuation">]</span>/ensure: ensure changed <span class="token string">'purged'</span> to <span class="token string">'present'</span><br><br>notice: /Stage<span class="token punctuation">[</span>main<span class="token punctuation">]</span>/Init/Package<span class="token punctuation">[</span>libjs-jquery-ui<span class="token punctuation">]</span>/ensure: ensure changed <span class="token string">'purged'</span> to <span class="token string">'present'</span><br><br>notice: /Stage<span class="token punctuation">[</span>main<span class="token punctuation">]</span>/Init/Package<span class="token punctuation">[</span>python-dev<span class="token punctuation">]</span>/ensure: ensure changed <span class="token string">'purged'</span> to <span class="token string">'present'</span><br><br>notice: /Stage<span class="token punctuation">[</span>main<span class="token punctuation">]</span>/Init/Exec<span class="token punctuation">[</span>pip-install-requirements<span class="token punctuation">]</span>/returns: executed successfully<br><br>notice: /Stage<span class="token punctuation">[</span>main<span class="token punctuation">]</span>/Init/Package<span class="token punctuation">[</span>gettext<span class="token punctuation">]</span>/ensure: ensure changed <span class="token string">'purged'</span> to <span class="token string">'present'</span><br><br>notice: /Stage<span class="token punctuation">[</span>main<span class="token punctuation">]</span>/Ltp/File<span class="token punctuation">[</span>/home/vagrant/ltp/loco_directory/local_settings.py<span class="token punctuation">]</span>/ensure: defined content as <span class="token string">'{md5}25234f94c80418dcb7cc59f3db2dd7f8'</span><br><br>notice: /Stage<span class="token punctuation">[</span>main<span class="token punctuation">]</span>/Ltp/Exec<span class="token punctuation">[</span>db_download<span class="token punctuation">]</span>/returns: executed successfully<br><br>notice: /Stage<span class="token punctuation">[</span>main<span class="token punctuation">]</span>/Ltp/Exec<span class="token punctuation">[</span>managepy_syncdb<span class="token punctuation">]</span>/returns: executed successfully<br><br>notice: /Stage<span class="token punctuation">[</span>main<span class="token punctuation">]</span>/Ltp/Exec<span class="token punctuation">[</span>managepy_migratedb<span class="token punctuation">]</span>/returns: executed successfully<br><br>notice: Finished catalog run <span class="token keyword">in</span> <span class="token number">811.47</span> seconds</code></pre> <p>After i started using Vagrant, my workflow imporved a lot i start focusing on writing code rather than resolving packages conflicts, i do use a VM for each bug fix/feature i need to work on, and once the fix is merged i simply delete the VM without thinking about breaking anything.</p> <p>[NB]: Ubuntu now officially supports Vagrant, and provides <a href="http://cloud-images.ubuntu.com/vagrant/">official Ubuntu boxes</a> for 12.04, 12.10, 13.04 and 13.10.</p> </div> </article> <div class="collection-nav"> <p class="collection-nav__item collection-nav__item--previous"> <a href="/2013/09/introduction-to-web-components-next-generation-markup.html">Introduction to Web Components, the Next Generation Markup</a> </p> <p class="collection-nav__item collection-nav__item--next"> <a href="/2013/10/package-your-webapp-for-ubuntu-touch.html">Package your Webapp for Ubuntu Touch</a> </p> </div> </div> </main> <footer> <p class="footer__copyright">© 2013–2022 Adnane Belmadiaf.</p> <p class="footer__colophon">This work is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" title="CC BY 4.0">Creative Commons Attribution 4.0 International</a></p> <p class="footer__colophon">Please ensure any redistribution adheres to the <a href="https://wiki.creativecommons.org/wiki/Best_practices_for_attribution" target="_blank" title="Creative Commons Best Practices for Attribution">Creative Commons Best Practices for Attribution</a>.</p> </footer> <script>document.addEventListener("DOMContentLoaded",function(){var e,t=localStorage.getItem("color-scheme")||(t="(prefers-color-scheme: dark)",(e=window.matchMedia?window.matchMedia(t):{}).media===t&&e.matches?"dark":"default");document.documentElement.setAttribute("data-color-scheme",t),document.getElementById("dark-mode-toggle").onclick=()=>{var e="default"===document.documentElement.getAttribute("data-color-scheme")?"dark":"default";document.documentElement.setAttribute("data-color-scheme",e),localStorage.setItem("color-scheme",e)}})</script>   </body></html>